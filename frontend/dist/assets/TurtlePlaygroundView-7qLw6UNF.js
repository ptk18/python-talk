import{_ as ft,S as _t,o as _,c as m,a as D,b as s,t as f,h as L,F as et,d as st,g as X,j as mt,v as vt,O as Ct,w as yt,l as xt,T as wt,m as bt,p as kt,q as nt,r as h,x as Tt,P as Mt,Q as Y,A as Pt,B as Lt,C as It,D as Z,H as v,L as Rt,J as Et,M as Wt}from"./index-DW7vJBLa.js";import{M as Vt}from"./MonacoEditor-msOWoLBd.js";import{r as At,u as Bt}from"./R-redo-BdLCXmmQ.js";class Dt{constructor(t,n=null){this.canvas=t,this.ctx=t.getContext("2d"),this.indicatorElement=n,this.x=t.width/2,this.y=t.height/2,this.heading=0,this.penDown=!0,this.penColor="#000000",this.penWidth=2,this.speed=5,this.visible=!0,this.fillColor="#000000",this.filling=!1,this.fillPath=[],this.clear()}forward(t){const n=this.heading*Math.PI/180,e=this.x+t*Math.cos(n),a=this.y-t*Math.sin(n);return this.penDown&&(this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.lineTo(e,a),this.ctx.strokeStyle=this.penColor,this.ctx.lineWidth=this.penWidth,this.ctx.lineCap="round",this.ctx.stroke()),this.filling&&this.fillPath.push({x:e,y:a}),this.x=e,this.y=a,this._updateIndicator(),`Moved forward ${t} pixels`}fd(t){return this.forward(t)}backward(t){return this.forward(-t)}bk(t){return this.backward(t)}back(t){return this.backward(t)}right(t){return this.heading=(this.heading-t)%360,this._updateIndicator(),`Turned right ${t} degrees`}rt(t){return this.right(t)}left(t){return this.heading=(this.heading+t)%360,this._updateIndicator(),`Turned left ${t} degrees`}lt(t){return this.left(t)}goto(t,n){n===void 0&&Array.isArray(t)&&(n=t[1],t=t[0]);const e=this.canvas.width/2+t,a=this.canvas.height/2-n;return this.penDown&&(this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.lineTo(e,a),this.ctx.strokeStyle=this.penColor,this.ctx.lineWidth=this.penWidth,this.ctx.lineCap="round",this.ctx.stroke()),this.filling&&this.fillPath.push({x:e,y:a}),this.x=e,this.y=a,this._updateIndicator(),`Moved to (${t}, ${n})`}setpos(t,n){return this.goto(t,n)}setposition(t,n){return this.goto(t,n)}setx(t){const n=this.canvas.width/2+t;return this.penDown&&(this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.lineTo(n,this.y),this.ctx.strokeStyle=this.penColor,this.ctx.lineWidth=this.penWidth,this.ctx.stroke()),this.x=n,this._updateIndicator(),`Set x to ${t}`}sety(t){const n=this.canvas.height/2-t;return this.penDown&&(this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.lineTo(this.x,n),this.ctx.strokeStyle=this.penColor,this.ctx.lineWidth=this.penWidth,this.ctx.stroke()),this.y=n,this._updateIndicator(),`Set y to ${t}`}setheading(t){return this.heading=t,this._updateIndicator(),`Heading set to ${t} degrees`}seth(t){return this.setheading(t)}home(){return this.goto(0,0),this.setheading(0),"Returned home"}position(){const t=Math.round(this.x-this.canvas.width/2),n=Math.round(this.canvas.height/2-this.y);return`Position: (${t}, ${n})`}pos(){return this.position()}xcor(){return Math.round(this.x-this.canvas.width/2)}ycor(){return Math.round(this.canvas.height/2-this.y)}getHeading(){return this.heading}isdown(){return this.penDown}isFilling(){return this.filling}distance(t,n){n===void 0&&Array.isArray(t)&&(n=t[1],t=t[0]);const e=this.canvas.width/2+t,a=this.canvas.height/2-n,l=e-this.x,g=a-this.y;return Math.sqrt(l*l+g*g)}towards(t,n){n===void 0&&Array.isArray(t)&&(n=t[1],t=t[0]);const e=this.canvas.width/2+t,a=this.canvas.height/2-n,l=e-this.x,g=-(a-this.y);return Math.atan2(g,l)*180/Math.PI}write(t,n=!1,e="left",a="12px Arial"){return this.ctx.font=a,this.ctx.fillStyle=this.penColor,this.ctx.textAlign=e,this.ctx.fillText(String(t),this.x,this.y),`Wrote: ${t}`}undo(){return"Undo not implemented"}penup(){return this.penDown=!1,"Pen up"}pu(){return this.penup()}up(){return this.penup()}pendown(){return this.penDown=!0,"Pen down"}pd(){return this.pendown()}down(){return this.pendown()}pensize(t){return t!==void 0?(this.penWidth=t,`Pen size set to ${t}`):`Pen size: ${this.penWidth}`}width(t){return this.pensize(t)}pencolor(t){return t!==void 0?(this.penColor=t,`Pen color set to ${t}`):`Pen color: ${this.penColor}`}color(t,n){return t!==void 0?(this.penColor=t,n!==void 0?(this.fillColor=n,`Pen: ${t}, Fill: ${n}`):`Color set to ${t}`):`Pen: ${this.penColor}, Fill: ${this.fillColor}`}fillcolor(t){return t!==void 0?(this.fillColor=t,`Fill color set to ${t}`):`Fill color: ${this.fillColor}`}begin_fill(){return this.filling=!0,this.fillPath=[{x:this.x,y:this.y}],"Begin fill"}end_fill(){if(this.filling&&this.fillPath.length>2){this.ctx.beginPath(),this.ctx.moveTo(this.fillPath[0].x,this.fillPath[0].y);for(let t=1;t<this.fillPath.length;t++)this.ctx.lineTo(this.fillPath[t].x,this.fillPath[t].y);this.ctx.closePath(),this.ctx.fillStyle=this.fillColor,this.ctx.fill()}return this.filling=!1,this.fillPath=[],"End fill"}circle(t,n=360,e=null){e===null&&(e=Math.max(Math.abs(Math.round(n/5)),1));const a=n/e,l=2*Math.PI*t*Math.abs(n)/360/e,g=t>0?1:-1;for(let d=0;d<e;d++)this.left(a/2*g),this.forward(l),this.left(a/2*g);return`Drew circle with radius ${t}`}dot(t=null,n=null){const e=t||Math.max(this.penWidth+4,2*this.penWidth),a=n||this.penColor;return this.ctx.beginPath(),this.ctx.arc(this.x,this.y,e/2,0,2*Math.PI),this.ctx.fillStyle=a,this.ctx.fill(),`Drew dot with size ${e}`}stamp(){return this._drawTurtle(),"Stamped turtle"}showturtle(){return this.visible=!0,this._updateIndicator(),"Turtle visible"}st(){return this.showturtle()}hideturtle(){return this.visible=!1,this._updateIndicator(),"Turtle hidden"}ht(){return this.hideturtle()}isvisible(){return this.visible}speed(t){return t!==void 0?(this.speed=Math.min(Math.max(t,0),10),`Speed set to ${this.speed}`):`Speed: ${this.speed}`}clear(){return this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this._updateIndicator(),"Canvas cleared"}reset(){return this.clear(),this.x=this.canvas.width/2,this.y=this.canvas.height/2,this.heading=0,this.penDown=!0,this.penColor="#000000",this.penWidth=2,this.fillColor="#000000",this.filling=!1,this.fillPath=[],this._updateIndicator(),"Turtle reset"}bgcolor(t){return t!==void 0?(this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),`Background color set to ${t}`):"Background color"}_drawTurtle(){const n=this.heading*Math.PI/180;this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(-n+Math.PI/2),this.ctx.beginPath(),this.ctx.moveTo(0,-12),this.ctx.lineTo(12/2,12/2),this.ctx.lineTo(0,12/4),this.ctx.lineTo(-12/2,12/2),this.ctx.closePath(),this.ctx.fillStyle="#024A14",this.ctx.fill(),this.ctx.strokeStyle="#01350e",this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.restore()}_updateIndicator(){if(!this.indicatorElement)return;if(!this.visible){this.indicatorElement.style.display="none";return}this.indicatorElement.style.display="block";const t=this.canvas.parentElement;if(!t)return;const n=this.canvas.getBoundingClientRect(),e=t.getBoundingClientRect(),a=n.left-e.left,l=n.top-e.top;this.indicatorElement.style.left=`${a+this.x}px`,this.indicatorElement.style.top=`${l+this.y}px`,this.indicatorElement.style.transform=`translate(-50%, -100%) rotate(${-this.heading+90}deg)`}setIndicatorElement(t){this.indicatorElement=t,this._updateIndicator()}}function it(o){if(!o||!o.trim())return[];const t=[];let n="",e=!1,a="",l=0;for(let g=0;g<o.length;g++){const d=o[g];e?(n+=d,d===a&&o[g-1]!=="\\"&&(e=!1)):d==='"'||d==="'"?(e=!0,a=d,n+=d):d==="("||d==="["?(l++,n+=d):d===")"||d==="]"?(l--,n+=d):d===","&&l===0?(t.push(O(n.trim())),n=""):n+=d}return n.trim()&&t.push(O(n.trim())),t}function O(o){if(o.includes("=")&&!o.startsWith("[")&&!o.startsWith("(")){const t=o.split("=");if(t.length===2)return O(t[1].trim())}return/^-?\d+\.?\d*$/.test(o)?parseFloat(o):o.startsWith('"')&&o.endsWith('"')||o.startsWith("'")&&o.endsWith("'")?o.slice(1,-1):o==="True"||o==="true"?!0:o==="False"||o==="false"?!1:o==="None"||o==="null"?null:o.startsWith("[")||o.startsWith("(")?it(o.slice(1,-1)):o}function ot(o,t){const n=o.match(/^(\w+)(?:\.(\w+))?\s*\((.*)\)\s*$/);if(!n)return{success:!1,result:null,error:`Invalid command syntax: ${o}`};const e=n[2]||n[1],a=it(n[3]);if(typeof t[e]=="function")try{return{success:!0,result:t[e](...a),error:null}}catch(l){return{success:!1,result:null,error:l.message}}return{success:!1,result:null,error:`Unknown method: ${e}`}}function zt(o,t){return o.split(";").map(e=>e.trim()).filter(e=>e).map(e=>({command:e,...ot(e,t)}))}function Ht(o,t){if(!o||!o.trim())return{success:!1,result:null,error:"Empty command"};if(!o.includes(";"))return ot(o.trim(),t);const n=zt(o,t),e=n.filter(a=>!a.success);return e.length>0?{success:!1,result:n.map(a=>a.result).filter(a=>a).join(", "),error:e.map(a=>a.error).join("; ")}:{success:!0,result:n.map(a=>a.result).join(", "),error:null}}const Ft="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.0435%2010.6614C17.8831%2010.4789%2017.7947%2010.2443%2017.7947%2010.0014C17.7947%209.75845%2017.8831%209.52385%2018.0435%209.34136L19.3235%207.90136C19.4645%207.74403%2019.5521%207.54606%2019.5736%207.33587C19.5952%207.12567%2019.5496%206.91405%2019.4435%206.73136L17.4435%203.27136C17.3384%203.08888%2017.1783%202.94424%2016.9862%202.85805C16.7941%202.77186%2016.5796%202.74852%2016.3735%202.79136L14.4935%203.17136C14.2542%203.22079%2014.0052%203.18095%2013.7933%203.05936C13.5815%202.93777%2013.4214%202.74284%2013.3435%202.51136L12.7335%200.68136C12.6664%200.482739%2012.5386%200.310225%2012.3681%200.188202C12.1976%200.0661789%2011.9931%200.000818796%2011.7835%200.00135996H7.78345C7.56538%20-0.0100221%207.34959%200.0502863%207.16902%200.173074C6.98845%200.295862%206.85303%200.474379%206.78345%200.68136L6.22345%202.51136C6.14545%202.74284%205.98542%202.93777%205.77356%203.05936C5.5617%203.18095%205.31267%203.22079%205.07345%203.17136L3.14345%202.79136C2.948%202.76374%202.74875%202.79458%202.5708%202.88C2.39285%202.96542%202.24415%203.10159%202.14345%203.27136L0.143451%206.73136C0.034611%206.91201%20-0.0143269%207.12245%200.00363355%207.33258C0.021594%207.54272%200.105533%207.7418%200.243451%207.90136L1.51345%209.34136C1.67377%209.52385%201.76219%209.75845%201.76219%2010.0014C1.76219%2010.2443%201.67377%2010.4789%201.51345%2010.6614L0.243451%2012.1014C0.105533%2012.2609%200.021594%2012.46%200.00363355%2012.6701C-0.0143269%2012.8803%200.034611%2013.0907%200.143451%2013.2714L2.14345%2016.7314C2.24855%2016.9138%202.40857%2017.0585%202.6007%2017.1447C2.79284%2017.2309%203.00728%2017.2542%203.21345%2017.2114L5.09345%2016.8314C5.33267%2016.7819%205.5817%2016.8218%205.79356%2016.9434C6.00542%2017.0649%206.16545%2017.2599%206.24345%2017.4914L6.85345%2019.3214C6.92303%2019.5283%207.05845%2019.7069%207.23902%2019.8296C7.41959%2019.9524%207.63538%2020.0127%207.85345%2020.0014H11.8535C12.0631%2020.0019%2012.2676%2019.9365%2012.4381%2019.8145C12.6086%2019.6925%2012.7364%2019.52%2012.8035%2019.3214L13.4135%2017.4914C13.4915%2017.2599%2013.6515%2017.0649%2013.8633%2016.9434C14.0752%2016.8218%2014.3242%2016.7819%2014.5635%2016.8314L16.4435%2017.2114C16.6496%2017.2542%2016.8641%2017.2309%2017.0562%2017.1447C17.2483%2017.0585%2017.4084%2016.9138%2017.5135%2016.7314L19.5135%2013.2714C19.6196%2013.0887%2019.6652%2012.877%2019.6436%2012.6669C19.6221%2012.4567%2019.5345%2012.2587%2019.3935%2012.1014L18.0435%2010.6614ZM16.5535%2012.0014L17.3535%2012.9014L16.0735%2015.1214L14.8935%2014.8814C14.1732%2014.7341%2013.424%2014.8565%2012.788%2015.2252C12.1521%2015.5938%2011.6736%2016.1832%2011.4435%2016.8814L11.0635%2018.0014H8.50345L8.14345%2016.8614C7.91331%2016.1632%207.43483%2015.5738%206.79886%2015.2052C6.16288%2014.8365%205.41367%2014.7141%204.69345%2014.8614L3.51345%2015.1014L2.21345%2012.8914L3.01345%2011.9914C3.50541%2011.4413%203.77738%2010.7293%203.77738%209.99136C3.77738%209.25343%203.50541%208.54138%203.01345%207.99136L2.21345%207.09136L3.49345%204.89136L4.67345%205.13136C5.39367%205.27858%206.14288%205.15624%206.77886%204.78756C7.41483%204.41888%207.89331%203.82952%208.12345%203.13136L8.50345%202.00136H11.0635L11.4435%203.14136C11.6736%203.83952%2012.1521%204.42888%2012.788%204.79756C13.424%205.16624%2014.1732%205.28858%2014.8935%205.14136L16.0735%204.90136L17.3535%207.12136L16.5535%208.02136C16.067%208.57012%2015.7984%209.27804%2015.7984%2010.0114C15.7984%2010.7447%2016.067%2011.4526%2016.5535%2012.0014ZM9.78345%206.00136C8.99233%206.00136%208.21897%206.23596%207.56117%206.67548C6.90337%207.11501%206.39068%207.73972%206.08793%208.47063C5.78518%209.20153%205.70597%2010.0058%205.86031%2010.7817C6.01465%2011.5576%206.39561%2012.2704%206.95502%2012.8298C7.51443%2013.3892%208.22717%2013.7702%209.00309%2013.9245C9.77901%2014.0788%2010.5833%2013.9996%2011.3142%2013.6969C12.0451%2013.3941%2012.6698%2012.8814%2013.1093%2012.2236C13.5489%2011.5658%2013.7835%2010.7925%2013.7835%2010.0014C13.7835%208.94049%2013.362%207.92308%2012.6119%207.17293C11.8617%206.42279%2010.8443%206.00136%209.78345%206.00136ZM9.78345%2012.0014C9.38789%2012.0014%209.00121%2011.8841%208.67231%2011.6643C8.34341%2011.4445%208.08707%2011.1322%207.93569%2010.7667C7.78432%2010.4013%207.74471%209.99914%207.82188%209.61118C7.89905%209.22322%208.08953%208.86685%208.36924%208.58715C8.64894%208.30744%209.00531%208.11696%209.39327%208.03979C9.78123%207.96262%2010.1834%208.00223%2010.5488%208.1536C10.9143%208.30498%2011.2266%208.56132%2011.4464%208.89022C11.6662%209.21912%2011.7835%209.6058%2011.7835%2010.0014C11.7835%2010.5318%2011.5727%2011.0405%2011.1977%2011.4156C10.8226%2011.7906%2010.3139%2012.0014%209.78345%2012.0014Z'%20fill='black'/%3e%3c/svg%3e",Ut="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19%208V19.6C19%2020.2365%2018.7471%2020.847%2018.2971%2021.2971C17.847%2021.7471%2017.2365%2022%2016.6%2022H7.4C6.76348%2022%206.15303%2021.7471%205.70294%2021.2971C5.25286%2020.847%205%2020.2365%205%2019.6V8M16%205V3.2C16%202.54%2015.46%202%2014.8%202H9.2C8.54%202%208%202.54%208%203.2V5M16%205H8M16%205H21M8%205H3M12%2011V17M15%2011V17M9%2011V17'%20stroke='black'%20stroke-width='1.5'%20stroke-miterlimit='10'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",jt="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20%2011.0002C19.7554%209.24041%2018.9391%207.60985%2017.6766%206.35969C16.4142%205.10953%2014.7758%204.30911%2013.0137%204.08175C11.2516%203.85438%209.46362%204.21268%207.9252%205.10144C6.38678%205.9902%205.18325%207.36013%204.5%209.00019M4%205.00019V9.00019H8M4%2013.0002C4.24456%2014.76%205.06093%2016.3905%206.32336%2017.6407C7.58579%2018.8909%209.22424%2019.6913%2010.9863%2019.9186C12.7484%2020.146%2014.5364%2019.7877%2016.0748%2018.8989C17.6132%2018.0102%2018.8168%2016.6403%2019.5%2015.0002M20%2019.0002V15.0002H16'%20stroke='black'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",St={name:"TurtlePlayground",components:{Sidebar:_t,MonacoEditor:Vt},setup(){const o=Wt(),{language:t,setLanguage:n}=bt(),{ttsEnabled:e,setTTSEnabled:a}=kt(),l=nt(()=>Rt(t.value)),g=nt(()=>o.params.appId),d=h(""),z=()=>{n(t.value==="en"?"th":"en")},r=()=>{a(!e.value)},k=h(null),C=h(null),q=h(null),H=h(null),T=h(""),I=h(`import turtle

t = turtle.Turtle()
`),R=h(!1),M=h(!1),E=h(!1),W=h(null),F=h([]),K=h(""),J=h("success"),U=h(!1);let j=null;const y=(i,c="success",u=3500)=>{j&&clearTimeout(j),K.value=i,J.value=c,U.value=!0,j=setTimeout(()=>{U.value=!1},u)},Q=h([]),V=h([]),at=h(["turtle"]),P=h([]);let b=null;const rt=async()=>{try{const i=await Y.getMethods();if(i.success){Q.value=i.methods;const c={};i.methods.forEach(u=>{const p=u.category||"other";c[p]||(c[p]=[]),c[p].push(u)}),V.value=Object.entries(c).map(([u,p])=>({name:u,methods:p})),V.value.length>0&&(P.value=[V.value[0].name])}}catch(i){console.error("[TurtlePlayground] Failed to fetch methods:",i)}},lt=i=>{I.value=i},ct=i=>{const c=P.value.indexOf(i);c===-1?P.value.push(i):P.value.splice(c,1)},dt=i=>{T.value=`${i.name}(${i.params.join(", ")})`},ut=()=>{var i;(i=H.value)==null||i.undo()},ht=()=>{var i;(i=H.value)==null||i.redo()},gt=()=>{y(t.value==="th"?"เร็วๆ นี้":"Coming soon","success",2e3)},A=(i,c=null)=>{const u=c?`
# ${c}
${i}`:`
${i}`;I.value+=u},pt=async()=>{if(g.value)try{const i=await fetch(`http://localhost:8000/api/conversations/${g.value}/single`);if(i.ok){const c=await i.json();d.value=c.title||"",c.code&&(I.value=c.code)}}catch(i){console.warn("[TurtlePlayground] Failed to load app data:",i)}};Tt(async()=>{if(await Mt(),k.value){b=new Dt(k.value,C.value);try{await Y.prewarmPipeline()}catch(i){console.warn("[TurtlePlayground] Failed to pre-warm pipeline:",i)}await rt(),await pt()}});const G=i=>b?Ht(i,b):{success:!1,error:"Turtle not initialized"},$=async(i,c=null)=>{E.value=!0;try{let u=i;t.value==="th"&&(u=(await Et.translateToEnglish(i)).translated_text);const p=await Y.analyzeCommand(u,"en");if(p.success&&(p.executable||p.executables)){const w=p.executables||[p.executable],x=[],tt=[];let S=!0;for(const B of w){const N=G(B);N.success?(x.push(`${B} -> ${N.result}`),tt.push(`t.${B}`)):(x.push(`${B} -> Error: ${N.error}`),S=!1)}return y(x.join(" | "),S?"success":"error"),A(tt.join(`
`),c||i),S?(v.speak(l.value.turtlePlayground.commandExecuted),{success:!0,executables:w}):(v.speak(l.value.turtlePlayground.invalidCommand),{success:!1,error:"Some commands failed"})}else return y(p.error||l.value.turtlePlayground.invalidCommand,"error"),v.speak(l.value.turtlePlayground.invalidCommand),{success:!1,error:p.error}}catch(u){return console.error("[TurtlePlayground] Command error:",u),y(u.message,"error"),v.speak(l.value.turtlePlayground.invalidCommand),{success:!1,error:u.message}}finally{E.value=!1}};return{t:l,language:t,ttsEnabled:e,langIcon:It,soundIcon:Lt,nosoundIcon:Pt,undoIcon:Bt,redoIcon:At,settingsIcon:Ft,clearIcon:Ut,resetIcon:jt,toggleLanguage:z,toggleTTS:r,turtleCanvas:k,turtleIndicator:C,canvasWrapper:q,monacoEditor:H,commandText:T,codeContent:I,isRecording:R,isTranscribing:M,isProcessing:E,availableMethods:Q,methodCategories:V,activeModules:at,expandedCategories:P,appId:g,appName:d,alertMessage:K,alertType:J,showAlert:U,handleCodeUpdate:lt,toggleCategory:ct,insertMethod:dt,handleRunCommand:async()=>{if(!T.value.trim()||E.value)return;const i=T.value.trim(),c=G(i);c.success?(y(c.result,"success"),A(`t.${i}`),v.speak(l.value.turtlePlayground.commandExecuted)):await $(i,i)},handleMicClick:async()=>{if(v.enableAudioContext(),R.value)W.value&&W.value.state!=="inactive"&&W.value.stop(),R.value=!1;else try{v.speak(l.value.turtlePlayground.listening);const i=await navigator.mediaDevices.getUserMedia({audio:!0}),c=new MediaRecorder(i);F.value=[],c.ondataavailable=u=>F.value.push(u.data),c.onstop=async()=>{const u=new Blob(F.value,{type:"audio/webm"}),p=new File([u],`recording_${Date.now()}.webm`,{type:"audio/webm"});i.getTracks().forEach(w=>w.stop()),M.value=!0;try{const x=(await v.transcribe(p,t.value)).text||"";x&&!x.includes("[Error")?(T.value=x,M.value=!1,await $(x,x)):(y(t.value==="th"?"แปลงเสียงไม่สำเร็จ กรุณาลองอีกครั้ง":"Transcription failed. Please try again.","error"),v.speak(l.value.turtlePlayground.invalidCommand),M.value=!1)}catch(w){y(w.message,"error"),v.speak(l.value.turtlePlayground.invalidCommand),M.value=!1}},c.start(),W.value=c,R.value=!0}catch{v.speak("Microphone access denied")}},handleClear:()=>{if(b){b.clear();const i=l.value.turtlePlayground.canvasCleared||"Canvas cleared";y(i,"success"),A("t.clear()"),v.speak(i)}},handleReset:()=>{if(b){b.reset();const i=l.value.turtlePlayground.turtleReset||"Turtle reset";y(i,"success"),A("t.reset()"),v.speak(i)}},handleUndo:ut,handleRedo:ht,handleSettingsClick:gt}}},Nt={class:"app-container"},Xt={class:"main-content"},Yt={class:"top-header"},Zt={class:"section-header"},Ot={class:"page-title"},qt={class:"control-buttons"},Kt=["title"],Jt=["src"],Qt=["title"],Gt=["src"],$t={class:"content-area"},te={class:"turtle-playground"},ee={class:"turtle-playground__container"},se={class:"turtle-playground__left-column"},ne={class:"turtle-playground__code-panel"},ie={class:"turtle-playground__code-header"},oe={class:"turtle-playground__code-title"},ae={class:"turtle-playground__code-hint"},re={class:"turtle-playground__code-actions"},le=["title"],ce=["src"],de=["title"],ue=["src"],he=["title"],ge=["src"],pe={class:"turtle-playground__code-editor"},fe={class:"turtle-playground__methods-panel"},_e={class:"turtle-playground__methods-header"},me={key:0,class:"turtle-playground__module-badge"},ve={class:"turtle-playground__methods-scroll"},Ce={key:0,class:"turtle-playground__methods-empty"},ye={key:1},xe=["onClick"],we={class:"turtle-playground__category-name"},be={class:"turtle-playground__category-count"},ke={key:0,class:"turtle-playground__method-chips"},Te=["onClick","title"],Me={class:"turtle-playground__right-column"},Pe={class:"turtle-playground__canvas-panel"},Le={class:"turtle-playground__canvas-header"},Ie={class:"turtle-playground__canvas-controls"},Re=["title"],Ee=["src"],We=["title"],Ve=["src"],Ae={class:"turtle-playground__canvas-wrapper",ref:"canvasWrapper"},Be={ref:"turtleCanvas",width:"600",height:"450",class:"turtle-playground__canvas"},De={ref:"turtleIndicator",class:"turtle-playground__indicator"},ze={class:"turtle-playground__command-panel"},He={class:"turtle-playground__command-input-area"},Fe={class:"turtle-playground__input-row"},Ue=["placeholder"],je=["disabled"],Se={key:0,class:"turtle-playground__status-bar turtle-playground__status-bar--transcribing"},Ne={class:"turtle-playground__status-content"},Xe={class:"turtle-playground__status-text"},Ye={key:1,class:"turtle-playground__status-bar turtle-playground__status-bar--processing"},Ze={class:"turtle-playground__status-content"},Oe={class:"turtle-playground__status-text"},qe={class:"turtle-playground__alert-text"};function Ke(o,t,n,e,a,l){const g=Z("TopToolbar"),d=Z("Sidebar"),z=Z("MonacoEditor");return _(),m("div",Nt,[D(g),D(d),s("main",Xt,[s("header",Yt,[s("div",Zt,[s("h2",Ot,f(e.appName||e.t.turtlePlayground.pageTitle),1),s("div",qt,[s("button",{class:"control-button",onClick:t[0]||(t[0]=(...r)=>e.toggleLanguage&&e.toggleLanguage(...r)),title:`Switch to ${e.language==="en"?"Thai":"English"}`},[s("img",{src:e.langIcon,alt:"Language",class:"control-icon"},null,8,Jt)],8,Kt),s("button",{class:"control-button",onClick:t[1]||(t[1]=(...r)=>e.toggleTTS&&e.toggleTTS(...r)),title:e.ttsEnabled?"Disable Voice":"Enable Voice"},[s("img",{src:e.ttsEnabled?e.soundIcon:e.nosoundIcon,alt:"Sound",class:"control-icon"},null,8,Gt)],8,Qt)])])]),s("div",$t,[s("div",te,[s("div",ee,[s("div",se,[s("section",ne,[s("div",ie,[s("div",oe,[s("h3",null,f(e.language==="th"?"โค้ดเอดิเตอร์":"Code Editor"),1),s("span",ae,f(e.language==="th"?"คำสั่งเสียงจะถูกเพิ่มที่นี่อัตโนมัติ":"Voice commands will be appended here automatically"),1)]),s("div",re,[s("button",{class:"turtle-playground__icon-btn",onClick:t[2]||(t[2]=(...r)=>e.handleUndo&&e.handleUndo(...r)),title:e.language==="th"?"ย้อนกลับ":"Undo"},[s("img",{src:e.undoIcon,alt:"Undo",class:"turtle-playground__icon-img"},null,8,ce)],8,le),s("button",{class:"turtle-playground__icon-btn",onClick:t[3]||(t[3]=(...r)=>e.handleRedo&&e.handleRedo(...r)),title:e.language==="th"?"ทำซ้ำ":"Redo"},[s("img",{src:e.redoIcon,alt:"Redo",class:"turtle-playground__icon-img"},null,8,ue)],8,de),s("button",{class:"turtle-playground__icon-btn",onClick:t[4]||(t[4]=(...r)=>e.handleSettingsClick&&e.handleSettingsClick(...r)),title:e.language==="th"?"การตั้งค่า":"Settings"},[s("img",{src:e.settingsIcon,alt:"Settings",class:"turtle-playground__icon-img"},null,8,ge)],8,he)])]),s("div",pe,[D(z,{ref:"monacoEditor",code:e.codeContent,language:"python","onUpdate:code":e.handleCodeUpdate},null,8,["code","onUpdate:code"])])]),s("section",fe,[s("div",_e,[s("h3",null,f(e.language==="th"?"เมธอดที่ใช้ได้":"Available Methods"),1),e.activeModules.length>0?(_(),m("span",me,f(e.activeModules[0]),1)):L("",!0)]),s("div",ve,[e.availableMethods.length===0?(_(),m("div",Ce,f(e.language==="th"?"พิมพ์ import statement เพื่อดูเมธอดที่มี":"Type an import statement to see available methods"),1)):(_(),m("div",ye,[(_(!0),m(et,null,st(e.methodCategories,(r,k)=>(_(),m("div",{key:k,class:"turtle-playground__method-category"},[s("div",{class:"turtle-playground__category-header",onClick:C=>e.toggleCategory(r.name)},[s("span",we,f(r.name),1),s("span",be,f(r.methods.length)+" methods",1),(_(),m("svg",{class:X(["turtle-playground__category-chevron",{expanded:e.expandedCategories.includes(r.name)}]),width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},[...t[12]||(t[12]=[s("path",{d:"M6 9l6 6 6-6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])],2))],8,xe),e.expandedCategories.includes(r.name)?(_(),m("div",ke,[(_(!0),m(et,null,st(r.methods,C=>(_(),m("button",{key:C.name,class:"turtle-playground__method-chip",onClick:q=>e.insertMethod(C),title:C.docstring||C.name},f(C.name)+"("+f(C.params.join(", "))+") ",9,Te))),128))])):L("",!0)]))),128))]))])])]),s("div",Me,[s("section",Pe,[s("div",Le,[s("h3",null,f(e.t.turtlePlayground.canvas),1),s("div",Ie,[s("button",{class:"turtle-playground__canvas-btn",onClick:t[5]||(t[5]=(...r)=>e.handleClear&&e.handleClear(...r)),title:e.t.turtlePlayground.clearCanvas},[s("img",{src:e.clearIcon,alt:"Clear",class:"turtle-playground__canvas-icon"},null,8,Ee)],8,Re),s("button",{class:"turtle-playground__canvas-btn",onClick:t[6]||(t[6]=(...r)=>e.handleReset&&e.handleReset(...r)),title:e.t.turtlePlayground.resetTurtle},[s("img",{src:e.resetIcon,alt:"Reset",class:"turtle-playground__canvas-icon"},null,8,Ve)],8,We)])]),s("div",Ae,[s("canvas",Be,null,512),s("div",De,null,512)],512)]),s("section",ze,[s("div",He,[s("div",Fe,[s("div",{class:X(["turtle-playground__mic",{"turtle-playground__mic--recording":e.isRecording}]),onClick:t[7]||(t[7]=(...r)=>e.handleMicClick&&e.handleMicClick(...r))},[...t[13]||(t[13]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M12 14C13.66 14 15 12.66 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14Z",fill:"currentColor"}),s("path",{d:"M17 11C17 13.76 14.76 16 12 16C9.24 16 7 13.76 7 11H5C5 14.53 7.61 17.43 11 17.92V21H13V17.92C16.39 17.43 19 14.53 19 11H17Z",fill:"currentColor"})],-1)])],2),mt(s("input",{type:"text",class:"turtle-playground__command-input",placeholder:e.language==="th"?"เช่น forward(100) หรือ พูดคำสั่ง...":"e.g., forward(100) or speak a command...","onUpdate:modelValue":t[8]||(t[8]=r=>e.commandText=r),onKeydown:t[9]||(t[9]=Ct(yt((...r)=>e.handleRunCommand&&e.handleRunCommand(...r),["prevent"]),["enter"]))},null,40,Ue),[[vt,e.commandText]]),s("button",{class:"turtle-playground__run-btn",onClick:t[10]||(t[10]=(...r)=>e.handleRunCommand&&e.handleRunCommand(...r)),disabled:e.isProcessing},[...t[14]||(t[14]=[s("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none"},[s("path",{d:"M5 3l14 9-14 9V3z",fill:"currentColor"})],-1)])],8,je)])])])])]),e.isTranscribing?(_(),m("div",Se,[s("div",Ne,[t[15]||(t[15]=s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"turtle-playground__status-spinner"},[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-dasharray":"60","stroke-dashoffset":"0"},[s("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})])],-1)),s("span",Xe,f(e.language==="th"?"กำลังแปลงเสียงของคุณ...":"Transcribing your voice..."),1),t[16]||(t[16]=s("div",{class:"turtle-playground__status-progress"},[s("div",{class:"turtle-playground__status-progress-bar"})],-1))])])):L("",!0),e.isProcessing?(_(),m("div",Ye,[s("div",Ze,[t[17]||(t[17]=s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"turtle-playground__status-spinner"},[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-dasharray":"60","stroke-dashoffset":"0"},[s("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})])],-1)),s("span",Oe,f(e.language==="th"?"กำลังประมวลผลและจับคู่คำสั่ง...":"Processing and mapping command..."),1),t[18]||(t[18]=s("div",{class:"turtle-playground__status-progress"},[s("div",{class:"turtle-playground__status-progress-bar"})],-1))])])):L("",!0),D(wt,{name:"alert-slide"},{default:xt(()=>[e.showAlert?(_(),m("div",{key:0,class:X(["turtle-playground__alert",`turtle-playground__alert--${e.alertType}`])},[s("span",qe,f(e.alertMessage),1),s("button",{class:"turtle-playground__alert-close",onClick:t[11]||(t[11]=r=>e.showAlert=!1)},"×")],2)):L("",!0)]),_:1})])])])])}const ns=ft(St,[["render",Ke]]);export{ns as default};
